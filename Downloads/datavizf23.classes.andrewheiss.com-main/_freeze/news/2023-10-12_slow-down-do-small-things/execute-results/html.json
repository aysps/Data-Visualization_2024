{
  "hash": "1abd97cd9ec813afb2621b158fad045e",
  "result": {
    "markdown": "---\ntitle: \"Slow down, simplify and do small things\"\ndate: \"2023-10-12T16:37\"\ncategories: [advice]\ntoc-depth: 4\n---\n\n\n\n\nHi everyone!\n\nNow that we're at the middle of the course, your plots and data manipulation are becoming more detailed and complex, which is good! Remember exercise 1, so long ago? All you had to do was this:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +\n  geom_point()\n```\n:::\n\n\nThat's all! Literally 3 lines of code.\n\nBut now with your mini projects, and (in the future) interactivity, maps, text analysis, and your final project, your code is getting longer and more complex. You'll have lots and lots of ggplot layers and functions chained together with `%>%`. You've learned so much!\n\nIt is *incredibly* tempting to write out all the code you want in one go and then try to run a complete chunk and hope that you got it all correct. And then when it's not correct, you try to change a bunch of things, hoping that they'll fix it and then they don't and you stay stuck and frustrated. You'll have a chunk of code that was 20–30 lines with an error somewhere and won't be able to find what went wrong or what was broken.\n\n**Don't do this!**\n\nHere's my best piece of advice for making more complex plots and for figuring out how to fix errors:\n\n> **Slow down, simplify, and do small things**\n\nRun your code incrementally (see [this past post here](/news/2023-10-12_messy-broken-code-tips.qmd) for some video examples about how to run stuff incrementally.). Start with a super basic plot and run it, then add a layer for labels and run it, then add a layer to change the fill gradient and run it, then add a layer to change the theme and run it, and so on. It feels slow, but it helps you understand what's going on and helps you fix things when they break.\n\nThis is not just my advice. [Julia Evans's](https://jvns.ca/) fantastic [*The Pocket Guide to Debugging*](https://wizardzines.com/zines/debugging-guide/) has the same piece of advice:\n\n![Page 39 from Julia Evans's *The Pocket Guide to Debugging*](img/pocket-debugging.png)\n\nWhen something doesn't work as expected, change just one thing at a time. Or even better, simplify it and then change one thing at a time.\n\nHere's a quick common example. Let's say you have a plot like this and you want to use the [plasma viridis scale](https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html#the-color-scales) for the colors of the points. It looks like it should work, but the colors aren't right! Those are just the default colors!\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  labs(x = \"Displacement\",\n       y = \"Highway MPG\",\n       color = \"Drive\") +\n  scale_fill_viridis_d(option = \"plasma\", end = 0.9) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](2023-10-12_slow-down-do-small-things_files/figure-html/example-broken-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\nHere's the process I would go through to figure out what's wrong and fix it:\n\n::: {.panel-tabset .nav-pills}\n### 1. Strip it down to a basic plot\n\nRight now there are a bunch of other layers (themes, labels, etc.). Maybe one of those is messing stuff up? We want to make sure the underlying plot works fine, so we'll strip down the plot to its simplest form—just the geoms\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](2023-10-12_slow-down-do-small-things_files/figure-html/step-1-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n### 2. Add simplified broken part\n\nGood, that works. Next we want to change the colors so that they use the viridis plasma palette. We used `scale_fill_viridis_d()` originally, but we also included a bunch of extra options (`option = \"plamsa\", end = 0.9`). Before using those, let's simplify it down and just use the default settings:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](2023-10-12_slow-down-do-small-things_files/figure-html/step-2-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n### 3. Figure out broken part\n\nThe colors still didn't change. But now we have a simplified working example of our broken code and we can examine it without worrying about the labels, themes, extra options, and all those other things. This should make it easier to see what's going on.\n\nThe issue here is that we used the color aesthetic (`color = drv`) and we're trying to change it with `scale_fill_*()`. That lets us control filled things (i.e. `fill = drv`). Since we're working with the color aesthetic, we need to use `scale_color_*()`. Let's try `scale_color_viridis_d()` and see if that fixes it:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  scale_color_viridis_d()\n```\n\n::: {.cell-output-display}\n![](2023-10-12_slow-down-do-small-things_files/figure-html/step-3-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n### 4. Add some parts back in\n\nThat fixed it! It's still not exactly what we wanted yet—we want the plasma palette and `end = 0.9`—but it's working now and we can add that back in: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  scale_color_viridis_d(option = \"plasma\", end = 0.9)\n```\n\n::: {.cell-output-display}\n![](2023-10-12_slow-down-do-small-things_files/figure-html/step-4-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n### 5. Add the rest back in\n\nCool, the palette changed and the other settings worked. The problem seems to be fixed now, so we can re-add all those other layers from the original plot. It's fixed!\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  labs(x = \"Displacement\",\n       y = \"Highway MPG\",\n       color = \"Drive\") +\n  scale_color_viridis_d(option = \"plasma\", end = 0.9) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](2023-10-12_slow-down-do-small-things_files/figure-html/step-5-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "2023-10-12_slow-down-do-small-things_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}